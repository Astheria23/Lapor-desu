<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Lapor Desu</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.5.1/MarkerCluster.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.5.1/MarkerCluster.Default.min.css" />
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="app-layout">
        <!-- Navigation -->
        <nav class="navbar">
            <div class="navbar-content">
                <div class="navbar-brand">
                    <h1 class="logo">L</h1>
                    <span class="brand-name">Lapor Desu</span>
                </div>
                <div class="navbar-actions">
                    <button id="report-btn" class="btn btn-primary">Lapor Masalah</button>
                    <div class="user-menu">
                        <button id="user-btn" class="user-button">
                            <span id="user-name">User</span>
                            <span class="dropdown-arrow">â–¼</span>
                        </button>
                        <div id="user-dropdown" class="dropdown-menu">
                            <a href="admin.html">Admin Dashboard</a>
                            <button id="logout-btn">Logout</button>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <div class="dashboard-layout">
            <!-- Map Container -->
            <div class="map-container">
                <div id="map" style="width: 100%; height: 100%;"></div>
            </div>

            <!-- Sidebar Filter -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <h2>Filter Laporan</h2>
                </div>
                <div class="sidebar-content">
                    <div id="category-filter">
                        <!-- Categories will be loaded here -->
                    </div>
                </div>
            </aside>
        </div>

        <!-- Report Modal -->
        <div id="report-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Buat Laporan Baru</h2>
                    <button id="close-modal" class="close-btn">&times;</button>
                </div>
                <form id="report-form" class="report-form">
                    <div class="form-group">
                        <label for="report-title">Judul Laporan</label>
                        <input type="text" id="report-title" required placeholder="Deskripsi singkat masalah">
                    </div>
                    <div class="form-group">
                        <label for="report-category">Kategori</label>
                        <select id="report-category" required>
                            <option value="">Pilih Kategori</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="report-description">Deskripsi Lengkap</label>
                        <textarea id="report-description" rows="4" required placeholder="Jelaskan masalah secara detail"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="report-location">Lokasi (Lat, Long)</label>
                        <input type="text" id="report-location" readonly placeholder="Klik pada peta untuk memilih lokasi">
                    </div>
                    <div class="form-group">
                        <label for="report-image">Foto Bukti</label>
                        <input type="file" id="report-image" accept="image/*">
                    </div>
                    <div class="form-actions">
                        <button type="button" id="cancel-btn" class="btn btn-secondary">Batal</button>
                        <button type="submit" class="btn btn-primary">Submit Laporan</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Detail Modal -->
        <div id="detail-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="detail-title">Detail Laporan</h2>
                    <button id="close-detail" class="close-btn">&times;</button>
                </div>
                <div class="detail-body">
                    <div id="detail-image-wrapper" style="margin: 8px 0; text-align:center;">
                        <img id="detail-image" alt="Bukti laporan" style="max-width:100%; max-height:320px; border-radius:8px; object-fit:contain;" />
                    </div>
                    <div class="detail-meta" style="display:grid; grid-template-columns: 1fr 1fr; gap:8px; font-size: 14px;">
                        <div><strong>Status:</strong> <span id="detail-status"></span></div>
                        <div><strong>Kategori:</strong> <span id="detail-category"></span></div>
                        <div><strong>Pelapor:</strong> <span id="detail-reporter"></span></div>
                        <div><strong>Waktu:</strong> <span id="detail-created"></span></div>
                        <div style="grid-column: 1 / -1;"><strong>Koordinat:</strong> <span id="detail-coordinates"></span></div>
                    </div>
                    <div class="detail-description" style="margin-top: 12px; font-size: 14px; color: #374151; white-space: pre-wrap;" id="detail-description"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.5.1/leaflet.markercluster.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.2/axios.min.js"></script>
    <script src="js/config.js"></script>
    <script src="js/api-client.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/map-manager.js"></script>
    <script src="js/pages/dashboard.js"></script>
</body>
</html>
